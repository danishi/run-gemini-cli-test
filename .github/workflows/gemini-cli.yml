name: 'ğŸ’¬ Gemini CLI'

on:
  pull_request_review_comment:
    types:
      - 'created'
  pull_request_review:
    types:
      - 'submitted'
  issue_comment:
    types:
      - 'created'
  issues:
    types:
      - 'opened'

concurrency:
  group: ${{ github.event.pull_request.number || github.event.issue.number || github.run_id }}
  cancel-in-progress: true

defaults:
  run:
    shell: 'bash'

permissions:
  contents: 'write'
  id-token: 'write'
  pull-requests: 'write'
  issues: 'write'

jobs:
  gemini-cli:
    # å®Ÿè¡Œæ¡ä»¶: æ˜ç¤ºçš„ã« @gemini ãŒå«ã¾ã‚Œã‚‹å ´åˆã®ã¿å‹•ä½œã•ã›ã‚‹ãŸã‚ã®è¤‡åˆæ¡ä»¶
    if: |-
      github.event_name == 'workflow_dispatch' ||
      (
        github.event_name == 'issues' && github.event.action == 'opened' &&
        contains(github.event.issue.body, '@gemini') &&
        !contains(github.event.issue.body, '@gemini /review') &&
        !contains(github.event.issue.body, '@gemini /triage') &&
        contains(fromJSON('["OWNER", "MEMBER", "COLLABORATOR"]'), github.event.issue.author_association)
      ) ||
      (
        (
          github.event_name == 'issue_comment' ||
          github.event_name == 'pull_request_review_comment'
        ) &&
        contains(github.event.comment.body, '@gemini') &&
        !contains(github.event.comment.body, '@gemini /review') &&
        !contains(github.event.comment.body, '@gemini /triage') &&
        contains(fromJSON('["OWNER", "MEMBER", "COLLABORATOR"]'), github.event.comment.author_association)
      ) ||
      (
        github.event_name == 'pull_request_review' &&
        contains(github.event.review.body, '@gemini') &&
        !contains(github.event.review.body, '@gemini /review') &&
        !contains(github.event.review.body, '@gemini /triage') &&
        contains(fromJSON('["OWNER", "MEMBER", "COLLABORATOR"]'), github.event.review.author_association)
      )
    timeout-minutes: 30
    runs-on: 'ubuntu-latest'

    steps:
      # ã‚¤ãƒ™ãƒ³ãƒˆãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆæœ¬æ–‡ã€Issue/PR ç•ªå·ã€PR åˆ¤å®šã‚’æŠ½å‡º
      - name: 'Get context from event'
        id: 'get_context'
        env:
          EVENT_NAME: '${{ github.event_name }}'
          EVENT_PAYLOAD: '${{ toJSON(github.event) }}'
        run: |-
          set -euo pipefail

          USER_REQUEST=""
          ISSUE_NUMBER=""
          IS_PR="false"

          if [[ "${EVENT_NAME}" == "issues" ]]; then
            USER_REQUEST=$(echo "${EVENT_PAYLOAD}" | jq -r .issue.body)
            ISSUE_NUMBER=$(echo "${EVENT_PAYLOAD}" | jq -r .issue.number)
          elif [[ "${EVENT_NAME}" == "issue_comment" ]]; then
            USER_REQUEST=$(echo "${EVENT_PAYLOAD}" | jq -r .comment.body)
            ISSUE_NUMBER=$(echo "${EVENT_PAYLOAD}" | jq -r .issue.number)
            if [[ $(echo "${EVENT_PAYLOAD}" | jq -r .issue.pull_request) != "null" ]]; then
              IS_PR="true"
            fi
          elif [[ "${EVENT_NAME}" == "pull_request_review" ]]; then
            USER_REQUEST=$(echo "${EVENT_PAYLOAD}" | jq -r .review.body)
            ISSUE_NUMBER=$(echo "${EVENT_PAYLOAD}" | jq -r .pull_request.number)
            IS_PR="true"
          elif [[ "${EVENT_NAME}" == "pull_request_review_comment" ]]; then
            USER_REQUEST=$(echo "${EVENT_PAYLOAD}" | jq -r .comment.body)
            ISSUE_NUMBER=$(echo "${EVENT_PAYLOAD}" | jq -r .pull_request.number)
            IS_PR="true"
          fi

          # Clean up user request
          USER_REQUEST=$(echo "${USER_REQUEST}" | sed 's/.*@gemini//' | sed 's/^[[:space:]]*//;s/[[:space:]]*$//')

          {
            echo "user_request=${USER_REQUEST}"
            echo "issue_number=${ISSUE_NUMBER}"
            echo "is_pr=${IS_PR}"
          } >> "${GITHUB_OUTPUT}"

      # ã‚³ãƒŸãƒƒãƒˆç”¨ã® Git ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è¨­å®š
      - name: 'Set up git user for commits'
        run: |-
          git config --global user.name 'gemini-cli[bot]'
          git config --global user.email 'gemini-cli[bot]@users.noreply.github.com'

      # PR ã®å ´åˆã¯ PR ãƒ˜ãƒƒãƒ‰ãƒ–ãƒ©ãƒ³ãƒã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
      - name: 'Checkout PR branch'
        if: |-
          ${{  steps.get_context.outputs.is_pr == 'true' }}
        uses: 'actions/checkout@v4'
        with:
          token: '${{ steps.generate_token.outputs.token || secrets.GITHUB_TOKEN }}'
          repository: '${{ github.repository }}'
          ref: 'refs/pull/${{ steps.get_context.outputs.issue_number }}/head'
          fetch-depth: 0

      # Issueï¼ˆé PRï¼‰ã®å ´åˆã¯æ—¢å®šãƒ–ãƒ©ãƒ³ãƒã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
      - name: 'Checkout main branch'
        if: |-
          ${{  steps.get_context.outputs.is_pr == 'false' }}
        uses: 'actions/checkout@v4'
        with:
          token: '${{ steps.generate_token.outputs.token || secrets.GITHUB_TOKEN }}'
          repository: '${{ github.repository }}'
          fetch-depth: 0

      # å—ä»˜ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æŠ•ç¨¿
      - name: 'Acknowledge request'
        env:
          GITHUB_ACTOR: '${{ github.actor }}'
          GITHUB_TOKEN: '${{ steps.generate_token.outputs.token || secrets.GITHUB_TOKEN }}'
          ISSUE_NUMBER: '${{ steps.get_context.outputs.issue_number }}'
          REPOSITORY: '${{ github.repository }}'
          REQUEST_TYPE: '${{ steps.get_context.outputs.request_type }}'
        run: |-
          set -euo pipefail
          MESSAGE="@${GITHUB_ACTOR} I've received your request and I'm working on it now! ğŸ¤–"
          if [[ -n "${MESSAGE}" ]]; then
            gh issue comment "${ISSUE_NUMBER}" \
              --body "${MESSAGE}" \
              --repo "${REPOSITORY}"
          fi

      # Issue/PR ã®æœ¬æ–‡ã‚’å–å¾—
      - name: 'Get description'
        id: 'get_description'
        env:
          GITHUB_TOKEN: '${{ steps.generate_token.outputs.token || secrets.GITHUB_TOKEN }}'
          IS_PR: '${{ steps.get_context.outputs.is_pr }}'
          ISSUE_NUMBER: '${{ steps.get_context.outputs.issue_number }}'
        run: |-
          set -euo pipefail
          if [[ "${IS_PR}" == "true" ]]; then
            DESCRIPTION=$(gh pr view "${ISSUE_NUMBER}" --json body --template '{{.body}}')
          else
            DESCRIPTION=$(gh issue view "${ISSUE_NUMBER}" --json body --template '{{.body}}')
          fi
          {
            echo "description<<EOF"
            echo "${DESCRIPTION}"
            echo "EOF"
          } >> "${GITHUB_OUTPUT}"

      # æ—¢å­˜ã®ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§ã‚’å–å¾—
      - name: 'Get comments'
        id: 'get_comments'
        env:
          GITHUB_TOKEN: '${{ steps.generate_token.outputs.token || secrets.GITHUB_TOKEN }}'
          IS_PR: '${{ steps.get_context.outputs.is_pr }}'
          ISSUE_NUMBER: '${{ steps.get_context.outputs.issue_number }}'
        run: |-
          set -euo pipefail
          if [[ "${IS_PR}" == "true" ]]; then
            COMMENTS=$(gh pr view "${ISSUE_NUMBER}" --json comments --template '{{range .comments}}{{.author.login}}: {{.body}}{{"\n"}}{{end}}')
          else
            COMMENTS=$(gh issue view "${ISSUE_NUMBER}" --json comments --template '{{range .comments}}{{.author.login}}: {{.body}}{{"\n"}}{{end}}')
          fi
          {
            echo "comments<<EOF"
            echo "${COMMENTS}"
            echo "EOF"
          } >> "${GITHUB_OUTPUT}"

      # Gemini CLI ã‚’å®Ÿè¡Œ
      - name: 'Run Gemini'
        id: 'run_gemini'
        uses: 'google-github-actions/run-gemini-cli@v0'
        env:
          GITHUB_TOKEN: '${{ steps.generate_token.outputs.token || secrets.GITHUB_TOKEN }}'
          REPOSITORY: '${{ github.repository }}'
          USER_REQUEST: '${{ steps.get_context.outputs.user_request }}'
          ISSUE_NUMBER: '${{ steps.get_context.outputs.issue_number }}'
          IS_PR: '${{ steps.get_context.outputs.is_pr }}'
        with:
          gemini_api_key: '${{ secrets.GEMINI_API_KEY }}'
          # gcp_workload_identity_provider: '${{ vars.GCP_WIF_PROVIDER }}'
          # gcp_project_id: '${{ vars.GOOGLE_CLOUD_PROJECT }}'
          # gcp_location: '${{ vars.GOOGLE_CLOUD_LOCATION }}'
          # gcp_service_account: '${{ vars.SERVICE_ACCOUNT_EMAIL }}'
          # use_vertex_ai: '${{ vars.GOOGLE_GENAI_USE_VERTEXAI }}'
          # use_gemini_code_assist: '${{ vars.GOOGLE_GENAI_USE_GCA }}'
          settings: |-
            {
              "maxSessionTurns": 50,
              "telemetry": {
                "enabled": false,
                "target": "gcp"
              }
            }
          prompt: |-
            ## å½¹å‰²

            ã‚ãªãŸã¯ GitHub ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å†…ã® CLI ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹çµŒç”±ã§å‘¼ã³å‡ºã•ã‚Œã‚‹æ”¯æ´çš„ãª AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚ãƒªãƒã‚¸ãƒˆãƒªã¨å¯¾è©±ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¿œç­”ã™ã‚‹ãŸã‚ã®å„ç¨®ãƒ„ãƒ¼ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

            ## ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

            - ãƒªãƒã‚¸ãƒˆãƒª: `${{ github.repository }}`
            - ãƒˆãƒªã‚¬ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆ: `${{ github.event_name }}`
            - Issue/PR ç•ªå·: `${{ steps.get_context.outputs.issue_number }}`
            - ã“ã‚Œã¯ PR ã‹: `${{ steps.get_context.outputs.is_pr }}`
            - Issue/PR ã®æœ¬æ–‡:
            `${{ steps.get_description.outputs.description }}`
            - ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§:
            `${{ steps.get_comments.outputs.comments }}`

            ## ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ

            ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™:
            `${{ steps.get_context.outputs.user_request }}`

            ## Issueãƒ»PR ã‚³ãƒ¡ãƒ³ãƒˆãƒ»è³ªå•ã¸ã®å¯¾å¿œæ–¹é‡

            ã“ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¯ä¸»ã«æ¬¡ã® 3 ã¤ã®ã‚·ãƒŠãƒªã‚ªã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚

            1. Issue ã®ä¿®æ­£ã‚’ä½œæˆã™ã‚‹
               - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨é–¢é€£ã™ã‚‹ Issue/PR ã®æœ¬æ–‡ã‚’ä¸å¯§ã«èª­ã¿ã¾ã™ã€‚
               - åˆ©ç”¨å¯èƒ½ãªãƒ„ãƒ¼ãƒ«ã§é–¢é€£ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’åé›†ã—ã¾ã™ï¼ˆä¾‹: `gh issue view`, `gh pr view`, `gh pr diff`, `cat`, `head`, `tail`ï¼‰ã€‚
               - å®Ÿè£…ã«é€²ã‚€å‰ã«ã€å•é¡Œã®æ ¹æœ¬åŸå› ã‚’ç‰¹å®šã—ã¾ã™ã€‚
               - ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã¨ã—ã¦ã€Œè¨ˆç”»ã€ã‚’ä½œæˆãƒ»ç¶­æŒã—ã¾ã™:
                 - æœ€åˆã«ã€å¯¾å¿œã«å¿…è¦ãªæ‰‹é †ã‚’ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼ˆ`- [ ] Task` å½¢å¼ï¼‰ã§ Issue/PR ã«ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿ã—ã¾ã™ã€‚
                 - ä¾‹:
                   ```
                   ### è¨ˆç”»
                   - [ ] æ ¹æœ¬åŸå› ã‚’èª¿æŸ»ã™ã‚‹
                   - [ ] `file.py` ã«ä¿®æ­£ã‚’å®Ÿè£…ã™ã‚‹
                   - [ ] ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ /å¤‰æ›´ã™ã‚‹
                   - [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›´æ–°ã™ã‚‹
                   - [ ] ä¿®æ­£ã‚’æ¤œè¨¼ã—ã¦ Issue ã‚’ã‚¯ãƒ­ãƒ¼ã‚ºã™ã‚‹
                   ```
                 - åˆå›æŠ•ç¨¿: `gh pr comment "${ISSUE_NUMBER}" --body "<plan>"` ã¾ãŸã¯ `gh issue comment "${ISSUE_NUMBER}" --body "<plan>"`
                 - é€²æ—ã«å¿œã˜ã¦åŒã˜ã‚³ãƒ¡ãƒ³ãƒˆã‚’ç·¨é›†ã—ã¦æœ€æ–°çŠ¶æ…‹ã‚’ä¿ã¡ã¾ã™ï¼ˆå®Œäº†ã¯ `- [x]`ï¼‰ã€‚
                   - æ›´æ–°æ‰‹é †:
                     1. ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚³ãƒ¡ãƒ³ãƒˆã® ID ã‚’å–å¾—ï¼ˆ`gh pr comment list "${ISSUE_NUMBER}"` ã¾ãŸã¯ `gh issue comment list "${ISSUE_NUMBER}"`ï¼‰ã€‚
                     2. å–å¾—ã—ãŸ ID ã®ã‚³ãƒ¡ãƒ³ãƒˆæœ¬æ–‡ã‚’æ›´æ–°:
                        - PR ã®å ´åˆ: `gh pr comment --edit <comment-id> --body "<updated plan>"`
                        - Issue ã®å ´åˆ: `gh issue comment --edit <comment-id> --body "<updated plan>"`
                     3. ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã¯ Issue/PR ã®ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦ã®ã¿ç¶­æŒã—ã€ã‚³ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«å†…ã§è¿½è·¡ãƒ»æ›´æ–°ã—ãªã„ã“ã¨ã€‚
               - ã‚³ãƒ¼ãƒ‰ä¿®æ­£ãŒå¿…è¦ãªå ´åˆã¯ã€å½±éŸ¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚„è©²å½“ç®‡æ‰€ã‚’ç‰¹å®šã—ã¾ã™ã€‚ä¸æ˜ç‚¹ãŒã‚ã‚Œã°ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®è³ªå•ã‚‚æ•´ç†ã—ã¾ã™ã€‚
               - åˆ©ç”¨å¯èƒ½ãªãƒ„ãƒ¼ãƒ«ï¼ˆä¾‹: `write_file`ï¼‰ã§ã‚³ãƒ¼ãƒ‰/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å¤‰æ›´ã—ã¾ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¦ç´„ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«å¾“ã„ã€ã‚·ã‚§ãƒ«å¤‰æ•°å‚ç…§ã¯èª¤å‹•ä½œé˜²æ­¢ã®ãŸã‚å¸¸ã« `"${VAR}"` å½¢å¼ã§æ›¸ãã¾ã™ã€‚
               - é–¢é€£ãƒ†ã‚¹ãƒˆã‚„ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã—ã¦æ„å›³é€šã‚Šå‹•ãã“ã¨ã‚’æ¤œè¨¼ã—ã€å¯èƒ½ã§ã‚ã‚Œã°è¨¼æ‹ ï¼ˆãƒ†ã‚¹ãƒˆå‡ºåŠ›ã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆç­‰ï¼‰ã‚’ç¤ºã—ã¾ã™ã€‚
               - ãƒ–ãƒ©ãƒ³ãƒé‹ç”¨ã¨ã‚³ãƒŸãƒƒãƒˆ:
                 - `main` ãƒ–ãƒ©ãƒ³ãƒã¸ç›´æ¥ã‚³ãƒŸãƒƒãƒˆã€Œã—ãªã„ã€ã§ãã ã•ã„ã€‚
                 - PR å¯¾å¿œï¼ˆ`IS_PR` ãŒ `true`ï¼‰ã§ã¯ã€æ­£ã—ã„ãƒ–ãƒ©ãƒ³ãƒãŒæ—¢ã«ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆæ¸ˆã¿ã§ã™ã€‚å˜ã«ã‚³ãƒŸãƒƒãƒˆã—ã¦ãƒ—ãƒƒã‚·ãƒ¥ã—ã¾ã™ã€‚
                   - `git add .`
                   - `git commit -m "feat: <describe the change>"`
                   - `git push`
                 - Issue å¯¾å¿œï¼ˆ`IS_PR` ãŒ `false`ï¼‰ã§ã¯ã€æ–°ã—ã„ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆã—ã¾ã™ã€‚ä¾‹: `issue/${ISSUE_NUMBER}/<short-description>`
                   - `git checkout -b issue/${ISSUE_NUMBER}/my-fix`
                   - `git add .`
                   - `git commit -m "feat: <describe the fix>"`
                   - `git push origin issue/${ISSUE_NUMBER}/my-fix`
                   - ãƒ—ãƒƒã‚·ãƒ¥å¾Œã€æ¬¡ã§ PR ã‚’ä½œæˆã§ãã¾ã™: `gh pr create --title "Fixes #${ISSUE_NUMBER}: <short title>" --body "This PR addresses issue #${ISSUE_NUMBER}."`
               - å¤‰æ›´å†…å®¹ã¨ç†ç”±ã®è¦ç´„ã‚’ Markdown ã«ã¾ã¨ã‚ã¾ã™: `write_file("response.md", "<your response here>")`
               - ã¾ã¨ã‚ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦æŠ•ç¨¿:
                 - PR: `gh pr comment "${ISSUE_NUMBER}" --body-file response.md`
                 - Issue: `gh issue comment "${ISSUE_NUMBER}" --body-file response.md`

            2. PR ä¸Šã®ã‚³ãƒ¡ãƒ³ãƒˆã¸ã®å¯¾å¿œ
               - å¯¾è±¡ã‚³ãƒ¡ãƒ³ãƒˆã¨ PR ã®æ–‡è„ˆã‚’èª­ã¿ã¾ã™ã€‚
               - `gh pr view`, `gh pr diff`, `cat` ãªã©ã§ã‚³ãƒ¼ãƒ‰ã¨è­°è«–ã®æµã‚Œã‚’æŠŠæ¡ã—ã¾ã™ã€‚
               - å¤‰æ›´ã‚„èª¬æ˜ã‚’æ±‚ã‚ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆãªã‚‰ã€Issue ä¿®æ­£æ™‚ã¨åŒæ§˜ã«è¨ˆç”»ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆâ†’å®Ÿè£…â†’ãƒ†ã‚¹ãƒˆâ†’ã‚³ãƒŸãƒƒãƒˆã®æµã‚Œã§å¯¾å¿œã—ã€ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’æ›´æ–°ã—ã¾ã™ã€‚
               - ã‚³ãƒŸãƒƒãƒˆ:
                 - æ­£ã—ã„ PR ãƒ–ãƒ©ãƒ³ãƒãŒãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆæ¸ˆã¿ã§ã™ã€‚å¤‰æ›´ã‚’è¿½åŠ ãƒ»ã‚³ãƒŸãƒƒãƒˆãƒ»ãƒ—ãƒƒã‚·ãƒ¥ã—ã¾ã™ã€‚
                 - `git add .`
                 - `git commit -m "fix: address review comments"`
                 - `git push`
               - è³ªå•ã§ã‚ã‚Œã°ã€å¿…è¦ã«å¿œã˜ã¦ã‚³ãƒ¼ãƒ‰ã‚„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å¼•ç”¨ã—ã¤ã¤ã€ç°¡æ½”ã‹ã¤æ˜ç¢ºã«å›ç­”ã—ã¾ã™ã€‚
               - å›ç­”ã¯ `response.md` ã«è¨˜è¿°ã—ã€PR ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦æŠ•ç¨¿: `gh pr comment "${ISSUE_NUMBER}" --body-file response.md`

            3. Issue ä¸Šã®è³ªå•ã«å›ç­”ã™ã‚‹
               - `gh issue view` ãªã©ã§è³ªå•ã¨ Issue ã®æ–‡è„ˆã‚’æŠŠæ¡ã—ã¾ã™ã€‚
               - å¿…è¦ã«å¿œã˜ã¦ãƒªãƒã‚¸ãƒˆãƒªã‚’èª¿æŸ»ãƒ»åˆ†æã—ã€æ­£ç¢ºãªå›ç­”ã‚’ç”¨æ„ã—ã¾ã™ã€‚
               - ã‚³ãƒ¼ãƒ‰/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¿®æ­£ãŒå¿…è¦ãªå ´åˆã¯ã€ä¸Šè¨˜ã®ä¿®æ­£ãƒ—ãƒ­ã‚»ã‚¹ï¼ˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆä½œæˆã¨æ›´æ–°ã‚’å«ã‚€ï¼‰ã«å¾“ã„ã€**ã‚»ã‚¯ã‚·ãƒ§ãƒ³1ã®ã¨ãŠã‚Šæ–°ã—ã„ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ** ã—ã¾ã™ã€‚
               - æ˜ç¢ºã§ç°¡æ½”ãªå›ç­”ã‚’ `response.md` ã«ã¾ã¨ã‚ã€Issue ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦æŠ•ç¨¿: `gh issue comment "${ISSUE_NUMBER}" --body-file response.md`

            ## ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

            - ç°¡æ½”ã§å®Ÿè¡Œå¯èƒ½ãªæŒ‡ç¤ºãƒ»å¤‰æ›´ã‚’å¿ƒãŒã‘ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®èª²é¡Œã‚’åŠ¹ç‡çš„ã«è§£æ±ºã—ã¾ã™ã€‚
            - ã‚³ãƒ¼ãƒ‰ã‚„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å¤‰æ›´ã—ãŸå ´åˆã¯ã€å¿…ãšã‚³ãƒŸãƒƒãƒˆã—ã¦ãƒ—ãƒƒã‚·ãƒ¥ã—ã¾ã™ã€‚
            - è§£æ±ºã‚„å›ç­”ã«ä¸ç¢ºå®Ÿæ€§ãŒã‚ã‚‹å ´åˆã¯ã€æ¨è«–ã‚’èª¬æ˜ã—ã¤ã¤ã€å¿…è¦ãªç¢ºèªè³ªå•ã‚’è¡Œã„ã¾ã™ã€‚
            - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¦ç´„ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«å¾“ã„ã¾ã™ã€‚
            - ã‚³ãƒ¡ãƒ³ãƒˆç­‰ã¯å¿…ãšæ—¥æœ¬èªã§ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã‚’è¡Œã„ã¾ã™ã€‚
